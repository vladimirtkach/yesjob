{% extends 'base.html' %}
{% block container %}


<div class="container">
    <h2>Данные о контакте</h2>
<a href="{% url 'sales:update_contact' сontact.id %}" class="btn btn-primary">Редактировать</a>

  <div class="row">
    <div class="col-sm">
    <p>Имя: {{сontact.first_name}}</p>
    <p>Фамилия: {{сontact.second_name}}</p>
    <p>Возраст: {{сontact.age}}</p>
    <p>Лид/Контакт: {{сontact.is_lead}}</p>
    <p>Профиль: {{сontact.profile}}</p>
    </div>
    <div class="col-sm">
    <p>Агент: {{сontact.agent}}</p>
    <p>Количество звонков: {{сontact.interaction_set.count}}</p>
    <p>Источник: {{сontact.source}}</p>
    <p>Дата след. контакта: {{сontact.next_contact_date}}</p>
    </div>
  </div>

    <hr style="width: 100%; color: black; height: 1px; background-color:grey;" />


  <h3>Добавить прозвон</h3>

  <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{form.as_p}}


      <div class="form-group">
          <label for="sel1">Список вакансий:</label>
          <select  class="form-control" id="vac_id" name="vac_id">
            <option value="nosale">---</option>
            {% for p in positions %}
            <option value="{{p.id}}">{{p.position_title}}</option>
            {% endfor %}
          </select>
      </div>





   <button type="submit" class="btn btn-primary"> Создать</button>
  </form>
  <style>
    ul.timeline {
    list-style-type: none;
    position: relative;
}
ul.timeline:before {
    content: ' ';
    background: #d4d9df;
    display: inline-block;
    position: absolute;
    left: 29px;
    width: 2px;
    height: 100%;
    z-index: 400;
}
ul.timeline > li {
    margin: 20px 0;
    padding-left: 20px;
}
ul.timeline > li:before {
    content: ' ';
    background: white;
    display: inline-block;
    position: absolute;
    border-radius: 50%;
    border: 3px solid #22c0e8;
    left: 20px;
    width: 20px;
    height: 20px;
    z-index: 400;
}
  </style>

        <hr style="width: 100%; color: black; height: 1px; background-color:grey;" />

  <div class="container mt-5 mb-5">
	<div class="row">
		<div class="col-md-6 offset-md-3">
			<h4>Взаимодействия с контактов</h4>
			<ul class="timeline">
                {% for i in interactions reversed %}
				<li>
					<p>Агент: {{i.agent.email }}, дата: {{i.interaction_date |date:"d-m-Y H:m"}}</p>
					<p>{{i.result}}</p>
                    <p>{% if i.order %}<b>Продажа:</b> {{i.order.vacancy}} {% endif %}</p>
				</li>
                {% endfor %}

			</ul>
		</div>
	</div>
</div>


  <script>
    jQuery('#id_date').datetimepicker({
      format:'Y-m-d H:i',
      lang:'ru'
});

  </script>

</div>

{% endblock container %}